"0","base_palette_len <- 10"
"0","get_palette <- colorRampPalette(pal_jco()(base_palette_len))"
"0",""
"0","n_states <- n_distinct(county_table$state)"
"0","palette_len <- ifelse(n_states > base_palette_len, n_states, base_palette_len)"
"0",""
"0","county_table %>%"
"0","  mutate(county = fct_reorder(county, risk_estimate)) %>%"
"0","  ggplot(aes(x = order, y = risk_estimate)) +"
"0","    geom_bar("
"0","      aes(fill = fct_reorder2(state, county, risk_estimate)),"
"0","      stat = ""identity"","
"0","      width = 0.8,"
"0","      alpha = 0.8"
"0","    ) +"
"0","    scale_x_discrete(labels = rev(county_table$county)) +"
"0","    scale_fill_manual(values = get_palette(palette_len)) +"
"0","    labs("
"0","      title = ""Counties with Highest Estimated Risk"","
"0","      x = """","
"0","      y = expression(rho),"
"0","      fill = ""state"""
"0","    ) +"
"0","    coord_flip()"
