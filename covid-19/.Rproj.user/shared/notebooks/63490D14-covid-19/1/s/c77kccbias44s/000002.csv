"0","getPalette = colorRampPalette(brewer.pal(9, ""Set1""))"
"0",""
"0","n_states <- n_distinct(county_table$state)"
"0","palette_len <- ifelse( n_states > 9, n_states, 9)"
"0",""
"0","county_table %>% "
"0","    mutate(county=fct_reorder(county,rate)) %>% "
"0","    ggplot(aes(x=county,y=rate)) +"
"0","        geom_bar(aes(fill=fct_reorder2(state,county,rate)),"
"0","                 stat=""identity"","
"0","                 width=0.65,"
"0","                 alpha=0.8,"
"0","                 color=""black"") +"
"0","        scale_fill_manual(values=getPalette(palette_len)) +"
"0","        labs("
"0","            title=""Counties with Highest Estimated Risk"","
"0","            x="""","
"0","            y=""estimate of risk (œÅ)"","
"0","            fill=""State"","
"0","            caption=""(d.edmonds)"""
"0","        ) +"
"0","        coord_flip()"
"0",""
