---
title: "db"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(DBI)
library(RMySQL)
```

```{r data}
games_df <- read_csv("~/Desktop/bq-results-20220327-002723-1648341846519.csv")
#games_df <- read_csv("~/Desktop/test_data.csv")  # test data set

#str(games_df)
```

```{r dbconnect}
ncaa_db <- dbConnect(
        RMariaDB::MariaDB(),
        #MySQL(),
        dbname = "ncaam",
        host = "localhost",
        port = 3306,
        user = "root",
        password = "rootroot"
      )

dbListTables(ncaa_db)
```

```{r dbedit}

#dbCreateTable(ncaa_db, "games", games_df)

dbWriteTable(ncaa_db, "games", games_df, overwrite = TRUE, row.names = FALSE)

games <- dbGetQuery(
  ncaa_db,
  "
    select *
    from ncaam.games
    ;
  "
)

#dbRemoveTable(ncaa_db, "games")
dbDisconnect(ncaa_db)

```
