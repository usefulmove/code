ggplot(aes(x=fct_reorder(name,value_ratio*1e4),y=value_ratio,fill=position)) +
geom_col(aes(fill=position),
color="black",
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="undervalued players by position",
x="", y="value ratio (per $10,000)"
)
width="0.8,
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio*1e4),y=value_ratio,fill=position)) +
geom_col(aes(fill=position),
color="black",
width="0.8",
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio*1e4),y=value_ratio,fill=position)) +
geom_col(aes(fill=position),
color="black",
width="0.8"
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio*1e4),y=value_ratio,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.8,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio*1e4),y=value_ratio,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.5,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio*1e4),y=value_ratio,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.65,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.65,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.65,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="top 50 undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=fct_reorder(position,value_ratio)),
color="black",
width=0.65,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="top 50 undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(50, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.7,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="top 50 undervalued players by position",
x="", y="value ratio (per $10,000)"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(25, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.7,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="top 25 undervalued players by position",
x="", y="value ratio (per $10,000)"
)
library(tidyverse)
library(ggthemes)
library(RColorBrewer)
theme_set(theme_minimal())
pros <- read_csv("players_20.csv")
pros <- pros %>%
mutate(name=short_name,
cost=value_eur,
wage=wage_eur,
positions=player_positions,
)
pros_position_longer <- pros %>%
separate(col=positions,
sep=",",
into=c("pos1","pos2","pos3")
) %>%
mutate(pos1=str_trim(pos1),
pos2=str_trim(pos2),
pos3=str_trim(pos3),
) %>%
pivot_longer(cols=c(pos1,pos2,pos3),
names_to="position_rank",
values_to="position",
values_drop_na=TRUE
)
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
group_by(club) %>%
summarise(rating=mean(overall),count=n()) %>%
filter(count>10) %>%
top_n(20, rating) %>%
arrange(desc(rating)) %>%
ggplot(aes(x=fct_reorder(club,rating),y=rating)) +
geom_bar(stat="identity",width=0.5,fill="#00c0ff") +
coord_flip()
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
group_by(club) %>%
summarise(roster_cost=sum(cost),count=n()) %>%
filter(count>10) %>%
top_n(20, roster_cost) %>%
arrange(desc(roster_cost)) %>%
ggplot(aes(x=fct_reorder(club,roster_cost),y=roster_cost)) +
geom_bar(stat="identity",width=0.5,fill="#00c0ff") +
coord_flip()
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
filter(cost!=0) %>%
group_by(club) %>%
summarise(rating=mean(overall),avg_cost=mean(cost),count=n()) %>%
filter(count>=11) %>%
ggplot(aes(x=avg_cost,y=rating)) +
geom_point() +
scale_x_continuous(trans="log10") +
labs(title="club player rating vs roster cost",
x="average roster cost (€)",
y="average overall rating"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(25, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.7,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="top 25 undervalued players by position",
x="", y="value ratio (per $10,000)"
)
library(tidyverse)
library(ggthemes)
library(RColorBrewer)
theme_set(theme_minimal())
pros <- read_csv("players_20.csv")
pros <- pros %>%
mutate(name=short_name,
cost=value_eur,
wage=wage_eur,
positions=player_positions,
)
pros_position_longer <- pros %>%
separate(col=positions,
sep=",",
into=c("pos1","pos2","pos3")
) %>%
mutate(pos1=str_trim(pos1),
pos2=str_trim(pos2),
pos3=str_trim(pos3),
) %>%
pivot_longer(cols=c(pos1,pos2,pos3),
names_to="position_rank",
values_to="position",
values_drop_na=TRUE
)
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
group_by(club) %>%
summarise(rating=mean(overall),count=n()) %>%
filter(count>10) %>%
top_n(30, rating) %>%
arrange(desc(rating)) %>%
ggplot(aes(x=fct_reorder(club,rating),y=rating)) +
geom_bar(stat="identity",width=0.5,fill="#00c0ff") +
coord_flip()
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
group_by(club) %>%
summarise(roster_cost=sum(cost),count=n()) %>%
filter(count>10) %>%
top_n(30, roster_cost) %>%
arrange(desc(roster_cost)) %>%
ggplot(aes(x=fct_reorder(club,roster_cost),y=roster_cost)) +
geom_bar(stat="identity",width=0.5,fill="#00c0ff") +
coord_flip()
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
filter(cost!=0) %>%
group_by(club) %>%
summarise(rating=mean(overall),avg_cost=mean(cost),count=n()) %>%
filter(count>=11) %>%
ggplot(aes(x=avg_cost,y=rating)) +
geom_point() +
scale_x_continuous(trans="log10") +
labs(title="club player rating vs roster cost",
x="average roster cost (€)",
y="average overall rating"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(30, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.7,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="top 30 undervalued players by position",
x="", y="value ratio (per $10,000)"
)
library(tidyverse)
library(ggthemes)
library(RColorBrewer)
theme_set(theme_minimal())
pros <- read_csv("players_20.csv")
pros <- pros %>%
mutate(name=short_name,
cost=value_eur,
wage=wage_eur,
positions=player_positions,
)
pros_position_longer <- pros %>%
separate(col=positions,
sep=",",
into=c("pos1","pos2","pos3")
) %>%
mutate(pos1=str_trim(pos1),
pos2=str_trim(pos2),
pos3=str_trim(pos3),
) %>%
pivot_longer(cols=c(pos1,pos2,pos3),
names_to="position_rank",
values_to="position",
values_drop_na=TRUE
)
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
group_by(club) %>%
summarise(rating=mean(overall),count=n()) %>%
filter(count>10) %>%
top_n(30, rating) %>%
arrange(desc(rating)) %>%
ggplot(aes(x=fct_reorder(club,rating),y=rating)) +
geom_bar(stat="identity",width=0.7,fill="#00c0ff",color="black") +
coord_flip()
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
group_by(club) %>%
summarise(roster_cost=sum(cost),count=n()) %>%
filter(count>10) %>%
top_n(30, roster_cost) %>%
arrange(desc(roster_cost)) %>%
ggplot(aes(x=fct_reorder(club,roster_cost),y=roster_cost)) +
geom_bar(stat="identity",width=0.7,fill="#00c0ff",color="black") +
coord_flip()
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
filter(cost!=0) %>%
group_by(club) %>%
summarise(rating=mean(overall),avg_cost=mean(cost),count=n()) %>%
filter(count>=11) %>%
ggplot(aes(x=avg_cost,y=rating)) +
geom_point() +
scale_x_continuous(trans="log10") +
labs(title="club player rating vs roster cost",
x="average roster cost (€)",
y="average overall rating"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(30, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.7,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="top 30 undervalued players by position",
x="", y="value ratio (per $10,000)"
)
library(tidyverse)
library(ggthemes)
library(RColorBrewer)
theme_set(theme_minimal())
pros <- read_csv("players_20.csv")
pros <- pros %>%
mutate(name=short_name,
cost=value_eur,
wage=wage_eur,
positions=player_positions,
)
pros_position_longer <- pros %>%
separate(col=positions,
sep=",",
into=c("pos1","pos2","pos3")
) %>%
mutate(pos1=str_trim(pos1),
pos2=str_trim(pos2),
pos3=str_trim(pos3),
) %>%
pivot_longer(cols=c(pos1,pos2,pos3),
names_to="position_rank",
values_to="position",
values_drop_na=TRUE
)
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
group_by(club) %>%
summarise(rating=mean(overall),count=n()) %>%
filter(count>10) %>%
top_n(30, rating) %>%
arrange(desc(rating)) %>%
ggplot(aes(x=fct_reorder(club,rating),y=rating)) +
geom_bar(stat="identity",width=0.7,fill="#00c0ff",color="black") +
coord_flip() +
labs(title="football clubs by average player rating",
x="", y="average player rating"
)
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
group_by(club) %>%
summarise(roster_cost=sum(cost),count=n()) %>%
filter(count>10) %>%
top_n(30, roster_cost) %>%
arrange(desc(roster_cost)) %>%
ggplot(aes(x=fct_reorder(club,roster_cost),y=roster_cost)) +
geom_bar(stat="identity",width=0.7,fill="#00c0ff",color="black") +
coord_flip() +
labs(title="football clubs by roster spending",
x="", y="average player cost (€)"
)
pros %>%
filter(!(team_position %in% c("SUB","RES"))) %>%
filter(cost!=0) %>%
group_by(club) %>%
summarise(rating=mean(overall),avg_cost=mean(cost),count=n()) %>%
filter(count>=11) %>%
ggplot(aes(x=avg_cost,y=rating)) +
geom_point() +
scale_x_continuous(trans="log10") +
labs(title="club player rating vs roster cost",
x="average roster cost (€)",
y="average overall rating"
)
pros_position_longer %>%
filter(cost!=0,
position_rank=="pos1",
position!="GK",
) %>%
mutate(value_ratio=overall/cost) %>%
top_n(30, value_ratio) %>%
ggplot(aes(x=fct_reorder(name,value_ratio),y=value_ratio*1e4,fill=position)) +
geom_col(aes(fill=position),
color="black",
width=0.7,
) +
coord_flip() +
geom_blank() +
scale_fill_brewer(palette="Set3") +
labs(title="top 30 undervalued players by position",
x="", y="value ratio (per $10,000)"
)
source('C:/Users/duane/repos/dedmonds/code/police/police.R', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
library(dplyr)
library(dslabs)
data(murders)
deaths <- read.csv("police_fatalities.csv")  # police fatality data
deaths <- read.csv("./awram-us-police-involved-fatalities/police_fatalities.csv")  # police fatality data
getwd()
